(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["Goals"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["Goals"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,a){return function(e){var t={};function a(l){if(t[l])return t[l].exports;var o=t[l]={i:l,l:!1,exports:{}};return e[l].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,l){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(l,o,function(t){return e[t]}.bind(null,o));return l},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/Goals/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"8bbf":function(e,a){e.exports=t},a5a2:function(e,t){e.exports=a},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"GoalPageLink",(function(){return s})),a.d(t,"ManageGoals",(function(){return Ve})),a.d(t,"ManageGoalsStore",(function(){return ye})),"undefined"!==typeof window){var l=window.document.currentScript,o=l&&l.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(a.p=o[1])}var n=a("19dc");function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r.apply(this,arguments)}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const{$:i}=window,c={mounted(e,t){if(!n["Matomo"].helper.isReportingPage())return;const a=i(e).text(),l=i("<a></a>");l.text(a),l.attr("title",Object(n["translate"])("Goals_ClickToViewThisGoal")),l.click(e=>{e.preventDefault(),n["MatomoUrl"].updateHash(r(r({},n["MatomoUrl"].hashParsed.value),{},{category:"Goals_Goals",subcategory:t.value.idGoal}))}),i(e).html(l[0])}};var s=c;n["Matomo"].on("Matomo.processDynamicHtml",e=>{e.find("[goal-page-link]").each((e,t)=>{if(i(t).attr("goal-page-link-handled"))return;const a=i(t).attr("goal-page-link");a&&c.mounted(t,{instance:null,value:{idGoal:a},oldValue:null,modifiers:{},dir:{}}),i(t).attr("goal-page-link-handled","1")})});var d=a("8bbf");const u={class:"manageGoals"},b={id:"entityEditContainer",feature:"true",class:"managegoals"},m={class:"contentHelp"},p=["innerHTML"],O={key:0},j=Object(d["createElementVNode"])("br",null,null,-1),h=Object(d["createElementVNode"])("br",null,null,-1),g=["innerHTML"],v={class:"first"},y={key:1},_={key:0},G={colspan:"8"},E=Object(d["createElementVNode"])("br",null,null,-1),V=Object(d["createElementVNode"])("br",null,null,-1),N=Object(d["createElementVNode"])("br",null,null,-1),w=["id"],f={class:"first"},S={class:"matchAttribute"},T={key:0},D={key:1},C=Object(d["createElementVNode"])("br",null,null,-1),k=["innerHTML"],x={key:1,style:{"padding-top":"2px"}},M=["onClick","title"],A=["onClick","title"],B={key:0,class:"tableActionBar"},L=Object(d["createElementVNode"])("span",{class:"icon-add"},null,-1),H={class:"ui-confirm",ref:"confirm"},F=["value"],P=["value"],U={class:"addEditGoal"},$=["innerHTML"],I={class:"row goalIsTriggeredWhen"},R={class:"col s12"},z={class:"row"},q={class:"col s12 m6 goalTriggerType"},W={class:"col s12 m6"},J=["innerHTML"],Y={class:"row whereTheMatchAttrbiute"},K={class:"col s12"},Q={class:"row"},X={class:"col s12 m6 l4"},Z={key:0,class:"col s12 m6 l4"},ee={key:1,class:"col s12 m6 l4"},te={class:"col s12 m6 l4"},ae={id:"examples_pattern",class:"col s12"},le=Object(d["createElementVNode"])("br",null,null,-1),oe=Object(d["createElementVNode"])("br",null,null,-1),ne=Object(d["createElementVNode"])("br",null,null,-1),re=Object(d["createElementVNode"])("br",null,null,-1),ie=Object(d["createElementVNode"])("br",null,null,-1),ce=Object(d["createElementVNode"])("br",null,null,-1),se=Object(d["createElementVNode"])("br",null,null,-1),de=Object(d["createElementVNode"])("br",null,null,-1),ue={ref:"endedittable"},be=Object(d["createElementVNode"])("input",{type:"hidden",name:"goalIdUpdate",value:""},null,-1),me={key:0},pe=["innerHTML"],Oe=Object(d["createElementVNode"])("a",{id:"bottom"},null,-1);function je(e,t,a,l,o,n){var r;const i=Object(d["resolveComponent"])("ActivityIndicator"),c=Object(d["resolveComponent"])("ContentBlock"),s=Object(d["resolveComponent"])("Field"),je=Object(d["resolveComponent"])("Alert"),he=Object(d["resolveComponent"])("VueEntryContainer"),ge=Object(d["resolveComponent"])("SaveButton"),ve=Object(d["resolveDirective"])("content-table"),ye=Object(d["resolveDirective"])("form");return Object(d["openBlock"])(),Object(d["createElementBlock"])("div",u,[Object(d["withDirectives"])(Object(d["createElementVNode"])("div",null,[Object(d["withDirectives"])(Object(d["createElementVNode"])("div",b,[Object(d["createVNode"])(c,{"content-title":e.translate("Goals_ManageGoals")},{default:Object(d["withCtx"])(()=>[Object(d["createVNode"])(i,{loading:e.isLoading},null,8,["loading"]),Object(d["createElementVNode"])("div",m,[Object(d["createElementVNode"])("span",{innerHTML:e.$sanitize(e.learnMoreAboutGoalTracking)},null,8,p),e.ecommerceEnabled?Object(d["createCommentVNode"])("",!0):(Object(d["openBlock"])(),Object(d["createElementBlock"])("span",O,[j,h,Object(d["createTextVNode"])(" "+Object(d["toDisplayString"])(e.translate("Goals_Optional"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Ecommerce"))+": ",1),Object(d["createElementVNode"])("span",{innerHTML:e.$sanitize(e.youCanEnableEcommerceReports)},null,8,g)]))]),Object(d["withDirectives"])((Object(d["openBlock"])(),Object(d["createElementBlock"])("table",null,[Object(d["createElementVNode"])("thead",null,[Object(d["createElementVNode"])("tr",null,[Object(d["createElementVNode"])("th",v,Object(d["toDisplayString"])(e.translate("General_Id")),1),Object(d["createElementVNode"])("th",null,Object(d["toDisplayString"])(e.translate("Goals_GoalName")),1),Object(d["createElementVNode"])("th",null,Object(d["toDisplayString"])(e.translate("General_Description")),1),Object(d["createElementVNode"])("th",null,Object(d["toDisplayString"])(e.translate("Goals_GoalIsTriggeredWhen")),1),Object(d["createElementVNode"])("th",null,Object(d["toDisplayString"])(e.translate("General_ColumnRevenue")),1),e.beforeGoalListActionsHeadComponent?(Object(d["openBlock"])(),Object(d["createBlock"])(Object(d["resolveDynamicComponent"])(e.beforeGoalListActionsHeadComponent),{key:0})):Object(d["createCommentVNode"])("",!0),e.userCanEditGoals?(Object(d["openBlock"])(),Object(d["createElementBlock"])("th",y,Object(d["toDisplayString"])(e.translate("General_Actions")),1)):Object(d["createCommentVNode"])("",!0)])]),Object(d["createElementVNode"])("tbody",null,[Object.keys(e.goals||{}).length?Object(d["createCommentVNode"])("",!0):(Object(d["openBlock"])(),Object(d["createElementBlock"])("tr",_,[Object(d["createElementVNode"])("td",G,[E,Object(d["createTextVNode"])(" "+Object(d["toDisplayString"])(e.translate("Goals_ThereIsNoGoalToManage",e.siteName))+" ",1),V,N])])),(Object(d["openBlock"])(!0),Object(d["createElementBlock"])(d["Fragment"],null,Object(d["renderList"])(e.goals||[],t=>(Object(d["openBlock"])(),Object(d["createElementBlock"])("tr",{id:t.idgoal,key:t.idgoal},[Object(d["createElementVNode"])("td",f,Object(d["toDisplayString"])(t.idgoal),1),Object(d["createElementVNode"])("td",null,Object(d["toDisplayString"])(t.name),1),Object(d["createElementVNode"])("td",null,Object(d["toDisplayString"])(t.description),1),Object(d["createElementVNode"])("td",null,[Object(d["createElementVNode"])("span",S,Object(d["toDisplayString"])(e.goalMatchAttributeTranslations[t.match_attribute]||t.match_attribute),1),"visit_duration"===t.match_attribute?(Object(d["openBlock"])(),Object(d["createElementBlock"])("span",T,Object(d["toDisplayString"])(e.lcfirst(e.translate("General_OperationGreaterThan")))+" "+Object(d["toDisplayString"])(e.translate("Intl_NMinutes",t.pattern)),1)):t.pattern_type?(Object(d["openBlock"])(),Object(d["createElementBlock"])("span",D,[C,Object(d["createTextVNode"])(" "+Object(d["toDisplayString"])(e.translate("Goals_Pattern"))+" "+Object(d["toDisplayString"])(t.pattern_type)+": "+Object(d["toDisplayString"])(t.pattern),1)])):Object(d["createCommentVNode"])("",!0)]),Object(d["createElementVNode"])("td",{class:"center",innerHTML:e.$sanitize(0===t.revenue||"0"===t.revenue?"-":t.revenue_pretty)},null,8,k),e.beforeGoalListActionsBodyComponent[t.idgoal]?(Object(d["openBlock"])(),Object(d["createBlock"])(Object(d["resolveDynamicComponent"])(e.beforeGoalListActionsBodyComponent[t.idgoal]),{key:0})):Object(d["createCommentVNode"])("",!0),e.userCanEditGoals?(Object(d["openBlock"])(),Object(d["createElementBlock"])("td",x,[e.userCanEditGoals?(Object(d["openBlock"])(),Object(d["createElementBlock"])("button",{key:0,onClick:a=>e.editGoal(t.idgoal),class:"table-action icon-edit",title:e.translate("General_Edit")},null,8,M)):Object(d["createCommentVNode"])("",!0),e.userCanEditGoals?(Object(d["openBlock"])(),Object(d["createElementBlock"])("button",{key:1,onClick:a=>e.deleteGoal(t.idgoal),class:"table-action icon-delete",title:e.translate("General_Delete")},null,8,A)):Object(d["createCommentVNode"])("",!0)])):Object(d["createCommentVNode"])("",!0)],8,w))),128))])])),[[ve]]),e.userCanEditGoals&&!e.onlyShowAddNewGoal?(Object(d["openBlock"])(),Object(d["createElementBlock"])("div",B,[Object(d["createElementVNode"])("button",{id:"add-goal",onClick:t[0]||(t[0]=t=>e.createGoal())},[L,Object(d["createTextVNode"])(" "+Object(d["toDisplayString"])(e.translate("Goals_AddNewGoal")),1)])])):Object(d["createCommentVNode"])("",!0)]),_:1},8,["content-title"])],512),[[d["vShow"],e.showGoalList]]),Object(d["createElementVNode"])("div",H,[Object(d["createElementVNode"])("h2",null,Object(d["toDisplayString"])(e.translate("Goals_DeleteGoalConfirm",`"${null===(r=e.goalToDelete)||void 0===r?void 0:r.name}"`)),1),Object(d["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,F),Object(d["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,P)],512)],512),[[d["vShow"],!e.onlyShowAddNewGoal]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("div",null,[Object(d["withDirectives"])(Object(d["createElementVNode"])("div",U,[Object(d["createVNode"])(c,{"content-title":e.goal.idgoal?e.translate("Goals_UpdateGoal"):e.translate("Goals_AddNewGoal")},{default:Object(d["withCtx"])(()=>[Object(d["createElementVNode"])("div",{innerHTML:e.$sanitize(e.addNewGoalIntro)},null,8,$),Object(d["withDirectives"])((Object(d["openBlock"])(),Object(d["createElementBlock"])("div",null,[Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"text",name:"goal_name",modelValue:e.goal.name,"onUpdate:modelValue":t[1]||(t[1]=t=>e.goal.name=t),maxlength:50,title:e.translate("Goals_GoalName"),onChange:e.goalNameChanged},null,8,["modelValue","title","onChange"])]),Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"text",name:"goal_description",modelValue:e.goal.description,"onUpdate:modelValue":t[2]||(t[2]=t=>e.goal.description=t),maxlength:255,title:e.translate("General_Description")},null,8,["modelValue","title"])]),Object(d["createElementVNode"])("div",I,[Object(d["createElementVNode"])("div",R,[Object(d["createElementVNode"])("h3",null,Object(d["toDisplayString"])(e.translate("Goals_GoalIsTriggered")),1)])]),Object(d["createElementVNode"])("div",z,[Object(d["createElementVNode"])("div",q,[Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"select",name:"trigger_type","model-value":e.triggerType,"onUpdate:modelValue":t[3]||(t[3]=t=>{e.triggerType=t,e.changedTriggerType()}),"full-width":!0,options:e.goalTriggerTypeOptions},null,8,["model-value","options"])])]),Object(d["createElementVNode"])("div",W,[Object(d["withDirectives"])(Object(d["createVNode"])(je,{severity:"info"},{default:Object(d["withCtx"])(()=>[Object(d["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whereVisitedPageManuallyCallsJsTrackerText)},null,8,J)]),_:1},512),[[d["vShow"],"manually"===e.triggerType]]),Object(d["createElementVNode"])("div",null,[Object(d["withDirectives"])(Object(d["createVNode"])(s,{uicontrol:"radio",name:"match_attribute","full-width":!0,"model-value":e.goal.match_attribute,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.goal.match_attribute=t,e.initPatternType()}),options:e.goalMatchAttributeOptions},null,8,["model-value","options"]),[[d["vShow"],"manually"!==e.triggerType]])])])]),Object(d["withDirectives"])(Object(d["createElementVNode"])("div",Y,[Object(d["createElementVNode"])("h3",K,[Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("Goals_WhereThe"))+" ",1),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("Goals_URL")),513),[[d["vShow"],"url"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("Goals_PageTitle")),513),[[d["vShow"],"title"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("Goals_Filename")),513),[[d["vShow"],"file"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("Goals_ExternalWebsiteUrl")),513),[[d["vShow"],"external_website"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("Goals_VisitDuration")),513),[[d["vShow"],"visit_duration"===e.goal.match_attribute]])])],512),[[d["vShow"],"manually"!==e.triggerType]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("div",Q,[Object(d["withDirectives"])(Object(d["createElementVNode"])("div",X,[Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"select",name:"event_type",modelValue:e.eventType,"onUpdate:modelValue":t[5]||(t[5]=t=>e.eventType=t),"full-width":!0,options:e.eventTypeOptions},null,8,["modelValue","options"])])],512),[[d["vShow"],"event"===e.goal.match_attribute]]),e.isMatchAttributeNumeric?Object(d["createCommentVNode"])("",!0):(Object(d["openBlock"])(),Object(d["createElementBlock"])("div",Z,[Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"select",name:"pattern_type",modelValue:e.goal.pattern_type,"onUpdate:modelValue":t[6]||(t[6]=t=>e.goal.pattern_type=t),"full-width":!0,options:e.patternTypeOptions},null,8,["modelValue","options"])])])),e.isMatchAttributeNumeric?(Object(d["openBlock"])(),Object(d["createElementBlock"])("div",ee,[Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"select",name:"pattern_type",modelValue:e.goal.pattern_type,"onUpdate:modelValue":t[7]||(t[7]=t=>e.goal.pattern_type=t),"full-width":!0,options:e.numericComparisonTypeOptions},null,8,["modelValue","options"])])])):Object(d["createCommentVNode"])("",!0),Object(d["createElementVNode"])("div",te,[Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"text",name:"pattern",modelValue:e.goal.pattern,"onUpdate:modelValue":t[8]||(t[8]=t=>e.goal.pattern=t),maxlength:255,title:e.patternFieldLabel,"full-width":!0},null,8,["modelValue","title"])])]),Object(d["createElementVNode"])("div",ae,[Object(d["createVNode"])(je,{severity:"info"},{default:Object(d["withCtx"])(()=>[Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,[Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Contains","'checkout/confirmation'"))+" ",1),le,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_IsExactly","'http://example.com/thank-you.html'"))+" ",1),oe,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_MatchesExpression","'(.*)\\/demo\\/(.*)'")),1)],512),[[d["vShow"],"url"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Contains","'Order confirmation'")),513),[[d["vShow"],"title"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,[Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Contains","'files/brochure.pdf'"))+" ",1),ne,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_IsExactly","'http://example.com/files/brochure.pdf'"))+" ",1),re,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_MatchesExpression","'(.*)\\.zip'")),1)],512),[[d["vShow"],"file"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,[Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Contains","'amazon.com'"))+" ",1),ie,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_IsExactly","'http://mypartner.com/landing.html'"))+" ",1),ce,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.matchesExpressionExternal),1)],512),[[d["vShow"],"external_website"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,[Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Contains","'video'"))+" ",1),se,Object(d["createTextVNode"])(" "+Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_IsExactly","'click'"))+" ",1),de,Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_MatchesExpression","'(.*)_banner'"))+'" ',1)],512),[[d["vShow"],"event"===e.goal.match_attribute]]),Object(d["withDirectives"])(Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(d["toDisplayString"])(e.translate("Goals_AtLeastMinutes","5","0.5")),513),[[d["vShow"],"visit_duration"===e.goal.match_attribute]])]),_:1})])],512),[[d["vShow"],"manually"!==e.triggerType]]),Object(d["createElementVNode"])("div",null,[Object(d["withDirectives"])(Object(d["createVNode"])(s,{uicontrol:"checkbox",name:"case_sensitive",modelValue:e.goal.case_sensitive,"onUpdate:modelValue":t[9]||(t[9]=t=>e.goal.case_sensitive=t),title:e.caseSensitiveTitle},null,8,["modelValue","title"]),[[d["vShow"],"manually"!==e.triggerType&&!e.isMatchAttributeNumeric]])]),Object(d["createElementVNode"])("div",null,["visit_duration"!==e.goal.match_attribute?(Object(d["openBlock"])(),Object(d["createBlock"])(s,{key:0,uicontrol:"radio",name:"allow_multiple","model-value":e.goal.allow_multiple&&"0"!==e.goal.allow_multiple?1:0,"onUpdate:modelValue":t[10]||(t[10]=t=>e.goal.allow_multiple=t),options:e.allowMultipleOptions,introduction:e.translate("Goals_AllowMultipleConversionsPerVisit"),"inline-help":e.translate("Goals_HelpOneConversionPerVisit")},null,8,["model-value","options","introduction","inline-help"])):Object(d["createCommentVNode"])("",!0)]),Object(d["createElementVNode"])("h3",null,Object(d["toDisplayString"])(e.translate("Goals_GoalRevenue"))+" "+Object(d["toDisplayString"])(e.translate("Goals_Optional")),1),Object(d["createElementVNode"])("div",null,[Object(d["createVNode"])(s,{uicontrol:"number",name:"revenue",modelValue:e.goal.revenue,"onUpdate:modelValue":t[11]||(t[11]=t=>e.goal.revenue=t),placeholder:e.translate("Goals_DefaultRevenueLabel"),"inline-help":e.translate("Goals_DefaultRevenueHelp")},null,8,["modelValue","placeholder","inline-help"])]),Object(d["createElementVNode"])("div",null,[Object(d["withDirectives"])(Object(d["createVNode"])(s,{uicontrol:"checkbox",name:"use_event_value",modelValue:e.goal.event_value_as_revenue,"onUpdate:modelValue":t[12]||(t[12]=t=>e.goal.event_value_as_revenue=t),title:e.translate("Goals_UseEventValueAsRevenue"),"inline-help":e.useEventValueAsRevenueHelp},null,8,["modelValue","title","inline-help"]),[[d["vShow"],"event"===e.goal.match_attribute]])]),Object(d["createElementVNode"])("div",ue,[e.endEditTable?(Object(d["openBlock"])(),Object(d["createBlock"])(he,{key:0,html:e.endEditTable},null,8,["html"])):Object(d["createCommentVNode"])("",!0)],512),be,Object(d["createVNode"])(ge,{saving:e.isLoading,onConfirm:t[13]||(t[13]=t=>e.save()),value:e.submitText},null,8,["saving","value"]),e.onlyShowAddNewGoal?Object(d["createCommentVNode"])("",!0):(Object(d["openBlock"])(),Object(d["createElementBlock"])("div",me,[Object(d["withDirectives"])(Object(d["createElementVNode"])("div",{class:"entityCancel",onClick:t[14]||(t[14]=t=>e.showListOfReports()),innerHTML:e.$sanitize(e.cancelText)},null,8,pe),[[d["vShow"],e.showEditGoal]])]))])),[[ye]])]),_:1},8,["content-title"])],512),[[d["vShow"],e.showEditGoal]])],512),[[d["vShow"],e.userCanEditGoals]]),Oe])}var he=a("a5a2");function ge(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class ve{constructor(){ge(this,"privateState",Object(d["reactive"])({})),ge(this,"idGoal",Object(d["computed"])(()=>this.privateState.idGoal))}setIdGoalShown(e){this.privateState.idGoal=e}}var ye=new ve;function _e(){return _e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},_e.apply(this,arguments)}function Ge(e){return e&&"0"!==e?1:0}var Ee=Object(d["defineComponent"])({inheritAttrs:!1,props:{onlyShowAddNewGoal:Boolean,userCanEditGoals:Boolean,ecommerceEnabled:Boolean,goals:{type:Object,required:!0},addNewGoalIntro:String,goalTriggerTypeOptions:Object,goalMatchAttributeOptions:Array,eventTypeOptions:Array,patternTypeOptions:Array,numericComparisonTypeOptions:Array,allowMultipleOptions:Array,showAddGoal:Boolean,showGoal:Number,beforeGoalListActionsBody:Object,endEditTable:String,beforeGoalListActionsHead:String},data(){return{showEditGoal:!1,showGoalList:!0,goal:{},isLoading:!1,eventType:"event_category",triggerType:"visitors",apiMethod:"",submitText:"",goalToDelete:null,addEditTableComponent:!1}},components:{SaveButton:he["SaveButton"],ContentBlock:n["ContentBlock"],ActivityIndicator:n["ActivityIndicator"],Field:he["Field"],Alert:n["Alert"],VueEntryContainer:n["VueEntryContainer"]},directives:{ContentTable:n["ContentTable"],Form:he["Form"]},created(){ye.setIdGoalShown(this.showGoal)},unmounted(){ye.setIdGoalShown(void 0)},mounted(){this.showAddGoal?this.createGoal():this.showGoal?this.editGoal(this.showGoal):this.showListOfReports()},methods:{scrollToTop(){setTimeout(()=>{n["Matomo"].helper.lazyScrollTo(".pageWrap",200)})},initGoalForm(e,t,a,l,o,r,i,c,s,d,u,b){n["Matomo"].postEvent("Goals.beforeInitGoalForm",e,b,a),this.apiMethod=e,this.goal={},this.goal.name=a,this.goal.description=l;let m=o;"manually"===m?(this.triggerType="manually",m="url"):this.triggerType="visitors",0===m.indexOf("event")?(this.eventType=m,m="event"):this.eventType="event_category",this.goal.match_attribute=m,this.goal.allow_multiple=d,this.goal.pattern_type=i,this.goal.pattern=r,this.goal.case_sensitive=c,this.goal.revenue=s,this.goal.event_value_as_revenue=u,this.submitText=t,this.goal.idgoal=b},showListOfReports(){n["Matomo"].postEvent("Goals.cancelForm"),this.showGoalList=!0,this.showEditGoal=!1,this.scrollToTop()},showAddEditForm(){this.showGoalList=!1,this.showEditGoal=!0},createGoal(){const e={isAllowed:!0};n["Matomo"].postEvent("Goals.initAddGoal",e),e&&!e.isAllowed||(this.showAddEditForm(),this.initGoalForm("Goals.addGoal",Object(n["translate"])("Goals_AddGoal"),"","","url","","contains",!1,0,!1,!1,0),this.scrollToTop())},editGoal(e){this.showAddEditForm();const t=this.goals[""+e];this.initGoalForm("Goals.updateGoal",Object(n["translate"])("Goals_UpdateGoal"),t.name,t.description,t.match_attribute,t.pattern,t.pattern_type,!!t.case_sensitive&&"0"!==t.case_sensitive,parseInt(""+t.revenue,10),!!t.allow_multiple&&"0"!==t.allow_multiple,!!t.event_value_as_revenue&&"0"!==t.event_value_as_revenue,e),this.scrollToTop()},deleteGoal(e){this.goalToDelete=this.goals[""+e],n["Matomo"].helper.modalConfirm(this.$refs.confirm,{yes:()=>{this.isLoading=!0,n["AjaxHelper"].fetch({idGoal:e,method:"Goals.deleteGoal"}).then(()=>{window.location.reload()}).finally(()=>{this.isLoading=!1})}})},save(){const e={};e.name=this.goal.name,e.description=this.goal.description,this.isManuallyTriggered?(e.matchAttribute="manually",e.patternType="regex",e.pattern=".*",e.caseSensitive=0):(e.matchAttribute=this.goal.match_attribute,"event"===e.matchAttribute&&(e.matchAttribute=this.eventType,e.useEventValueAsRevenue=Ge(this.goal.event_value_as_revenue)),e.patternType=this.goal.pattern_type,e.pattern=this.goal.pattern,e.caseSensitive=Ge(this.goal.case_sensitive)),e.revenue=this.goal.revenue||0,e.allowMultipleConversionsPerVisit=Ge(this.goal.allow_multiple),e.idGoal=this.goal.idgoal,e.method=this.apiMethod;const t="Goals.addGoal"===e.method,a="Goals.updateGoal"===e.method,l={};a?n["Matomo"].postEvent("Goals.beforeUpdateGoal",{parameters:e,options:l}):t&&n["Matomo"].postEvent("Goals.beforeAddGoal",{parameters:e,options:l}),null!==e&&void 0!==e&&e.cancelRequest||(this.isLoading=!0,n["AjaxHelper"].fetch(e,l).then(()=>{const e=n["MatomoUrl"].parsed.value.subcategory;"Goals_AddNewGoal"===e&&n["Matomo"].helper.isReportingPage()?n["ReportingMenuStore"].reloadMenuItems().then(()=>{n["MatomoUrl"].updateHash(_e(_e({},n["MatomoUrl"].hashParsed.value),{},{subcategory:"Goals_ManageGoals"})),this.isLoading=!1}):window.location.reload()}).catch(()=>{this.scrollToTop(),this.isLoading=!1}))},changedTriggerType(){this.isManuallyTriggered||this.goal.pattern_type||(this.goal.pattern_type="contains")},initPatternType(){this.isMatchAttributeNumeric?this.goal.pattern_type="greater_than":this.goal.pattern_type="contains"},lcfirst(e){return`${e.slice(0,1).toLowerCase()}${e.slice(1)}`},ucfirst(e){return`${e.slice(0,1).toUpperCase()}${e.slice(1)}`},goalNameChanged(){n["Matomo"].postEvent("Goals.goalNameChanged",this.goal.name)}},computed:{learnMoreAboutGoalTracking(){return Object(n["translate"])("Goals_LearnMoreAboutGoalTrackingDocumentation",Object(n["externalLink"])("https://matomo.org/docs/tracking-goals-web-analytics/"),"</a>")},youCanEnableEcommerceReports(){const e=n["MatomoUrl"].stringify(_e(_e({},n["MatomoUrl"].urlParsed.value),{},{module:"SitesManager",action:"index"})),t=Object(n["externalLink"])("https://matomo.org/docs/ecommerce-analytics/")+Object(n["translate"])("Goals_EcommerceReports")+"</a>",a=`<a href='${e}'>${Object(n["translate"])("SitesManager_WebsitesManagement")}</a>`;return Object(n["translate"])("Goals_YouCanEnableEcommerceReports",t,a)},siteName(){return n["Matomo"].helper.htmlDecode(n["Matomo"].siteName)},whereVisitedPageManuallyCallsJsTrackerText(){return Object(n["translate"])("Goals_WhereVisitedPageManuallyCallsJavascriptTrackerLearnMore",Object(n["externalLink"])("https://developer.matomo.org/guides/tracking-javascript-guide#manually-trigger-goal-conversions"),"</a>")},caseSensitiveTitle(){return`${Object(n["translate"])("Goals_CaseSensitive")} ${Object(n["translate"])("Goals_Optional")}`},useEventValueAsRevenueHelp(){return`${Object(n["translate"])("Goals_EventValueAsRevenueHelp")} <br/><br/> ${Object(n["translate"])("Goals_EventValueAsRevenueHelp2")}`},cancelText(){return Object(n["translate"])("General_OrCancel","<a class='entityCancelLink'>","</a>")},isMatchAttributeNumeric(){return["visit_duration"].indexOf(this.goal.match_attribute)>-1},patternFieldLabel(){return"visit_duration"===this.goal.match_attribute?Object(n["translate"])("Goals_TimeInMinutes"):Object(n["translate"])("Goals_Pattern")},goalMatchAttributeTranslations(){return{manually:Object(n["translate"])("Goals_ManuallyTriggeredUsingJavascriptFunction"),file:Object(n["translate"])("Goals_Download"),url:Object(n["translate"])("Goals_VisitUrl"),title:Object(n["translate"])("Goals_VisitPageTitle"),external_website:Object(n["translate"])("Goals_ClickOutlink"),event_action:`${Object(n["translate"])("Goals_SendEvent")} (${Object(n["translate"])("Events_EventAction")})`,event_category:`${Object(n["translate"])("Goals_SendEvent")} (${Object(n["translate"])("Events_EventCategory")})`,event_name:`${Object(n["translate"])("Goals_SendEvent")} (${Object(n["translate"])("Events_EventName")})`,visit_duration:""+this.ucfirst(Object(n["translate"])("Goals_VisitDuration"))}},beforeGoalListActionsBodyComponent(){if(!this.beforeGoalListActionsBody)return{};const e={};return Object.values(this.goals).forEach(t=>{const a=this.beforeGoalListActionsBody[t.idgoal];a&&(e[t.idgoal]={template:a})}),Object(d["markRaw"])(e)},beforeGoalListActionsHeadComponent(){return this.beforeGoalListActionsHead?Object(d["markRaw"])({template:this.beforeGoalListActionsHead}):null},isManuallyTriggered(){return"manually"===this.triggerType},matchesExpressionExternal(){const e="'http://www.amazon.com\\/(.*)\\/yourAffiliateId'";return Object(n["translate"])("Goals_MatchesExpression",e)}}});Ee.render=je;var Ve=Ee;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
*/}})}));
//# sourceMappingURL=Goals.umd.min.js.map