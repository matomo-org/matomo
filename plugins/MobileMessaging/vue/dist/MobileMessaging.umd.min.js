(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["MobileMessaging"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["MobileMessaging"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/MobileMessaging/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ReportParameters",(function(){return N})),n.d(t,"ManageSmsProvider",(function(){return q})),n.d(t,"SmsProviderCredentials",(function(){return H})),n.d(t,"DelegateMobileMessagingSettings",(function(){return I})),n.d(t,"ManageMobilePhoneNumbers",(function(){return je})),n.d(t,"SelectPhoneNumbers",(function(){return f})),n.d(t,"AdminPage",(function(){return Ae})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var i=n("8bbf"),a={key:0};function l(e,t,n,o,r,l){var c=Object(i["resolveComponent"])("SelectPhoneNumbers");return e.report&&"mobile"===e.report.type?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",a,[Object(i["createVNode"])(c,{"phone-numbers":e.phoneNumbers,"with-introduction":!0,"model-value":e.report.phoneNumbers,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("change","phoneNumbers",t)})},null,8,["phone-numbers","model-value"])])):Object(i["createCommentVNode"])("",!0)}var c={class:"mobile"},s={id:"mobilePhoneNumbersHelp",class:"inline-help-node"},d=Object(i["createElementVNode"])("span",{class:"icon-info",style:{"margin-right":"3.5px"}},null,-1),u={key:0,style:{"margin-right":"3.5px"}},m={key:1,style:{"margin-right":"3.5px"}},b=["href"];function p(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",c,[Object(i["createVNode"])(l,{uicontrol:"checkbox","var-type":"array",name:"phoneNumbers","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t)}),introduction:e.withIntroduction?e.translate("ScheduledReports_SendReportTo"):void 0,title:e.translate("MobileMessaging_PhoneNumbers"),disabled:0===e.phoneNumbers.length,options:e.phoneNumbers},{"inline-help":Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",s,[d,0===e.phoneNumbers.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",u,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_NoPhoneNumbers")),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",m,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_AdditionalPhoneNumbers")),1)),Object(i["createElementVNode"])("a",{href:e.linkTo({module:"MobileMessaging",action:"index",updated:null})},Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_MobileMessagingSettingsLink")),9,b)])]})),_:1},8,["model-value","introduction","title","disabled","options"])])}var g=n("19dc"),v=n("a5a2"),h=Object(i["defineComponent"])({props:{modelValue:Array,phoneNumbers:{type:[Array,Object],required:!0},withIntroduction:Boolean},emits:["update:modelValue"],components:{Field:v["Field"]},methods:{linkTo:function(e){return"?".concat(g["MatomoUrl"].stringify(Object.assign(Object.assign({},g["MatomoUrl"].urlParsed.value),e)))}}});h.render=p;var f=h,j="mobile",O=Object(i["defineComponent"])({props:{report:{type:Object,required:!0},phoneNumbers:{type:[Array,Object],required:!0}},components:{SelectPhoneNumbers:f},emits:["change"],created:function(){var e=window,t=e.resetReportParametersFunctions,n=e.updateReportParametersFunctions,o=e.getReportParametersFunctions;t[j]||(t[j]=function(e){e.phoneNumbers=[],e.formatmobile="sms"}),n[j]||(n[j]=function(e){null!==e&&void 0!==e&&e.parameters&&(e.parameters&&e.parameters.phoneNumbers&&(e.phoneNumbers=e.parameters.phoneNumbers),e.formatmobile="sms")}),o[j]||(o[j]=function(e){var t=e.phoneNumbers;return{phoneNumbers:t||[""]}})}});O.render=l;var N=O,M=Object(i["createElementVNode"])("div",{id:"ajaxErrorManageSmsProviderSettings"},null,-1),S={key:0},y={key:0},C=Object(i["createElementVNode"])("br",null,null,-1),P={key:1},V=Object(i["createElementVNode"])("br",null,null,-1),A=["innerHTML"],E={key:1},_={id:"accountForm"},k=["innerHTML"];function B(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SmsProviderCredentials"),d=Object(i["resolveComponent"])("SaveButton"),u=Object(i["resolveDirective"])("form");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(l,{loading:e.isDeletingAccount},null,8,["loading"]),M,e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",S,[e.credentialError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",y,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialInvalid",e.provider)),1),C,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.credentialError),1)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",P,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialProvided",e.provider))+" "+Object(i["toDisplayString"])(e.creditLeft),1)),V,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.updateOrDeleteAccountText),onClick:t[0]||(t[0]=function(t){return e.onUpdateOrDeleteClick(t)})},null,8,A)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",E,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PleaseSignUp")),1)),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",_,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{uicontrol:"select",name:"smsProviders",modelValue:e.smsProvider,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.smsProvider=t}),title:e.translate("MobileMessaging_Settings_SMSProvider"),options:e.smsProviderOptions,value:e.provider},null,8,["modelValue","title","options","value"])]),Object(i["createVNode"])(s,{provider:e.smsProvider,modelValue:e.credentials,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.credentials=t}),t[3]||(t[3]=function(t){e.credentials=t})],"model-value":e.credentials},null,8,["provider","modelValue","model-value"]),Object(i["createVNode"])(d,{id:"apiAccountSubmit",disabled:!e.isUpdateAccountPossible,saving:e.isUpdatingAccount,onConfirm:t[4]||(t[4]=function(t){return e.updateAccount()})},null,8,["disabled","saving"]),Object(i["createElementVNode"])("div",{class:"providerDescription",innerHTML:e.$sanitize(e.currentProviderDescription)},null,8,k)],512),[[i["vShow"],!e.credentialSupplied||e.showAccountForm],[u]])])}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w={key:0};function U(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field");return e.fields?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",w,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.fields,(function(t){var n;return Object(i["openBlock"])(),Object(i["createBlock"])(l,{key:t.name,uicontrol:t.type,name:t.name,"model-value":null===(n=e.modelValue)||void 0===n?void 0:n[t.name],"onUpdate:modelValue":function(n){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},x({},t.name,n)))},title:e.translate(t.title)},null,8,["uicontrol","name","model-value","onUpdate:modelValue","title"])})),128))])):Object(i["createCommentVNode"])("",!0)}var D=Object(i["reactive"])({}),F=Object(i["defineComponent"])({props:{provider:{type:String,required:!0},modelValue:Object},emits:["update:modelValue"],components:{Field:v["Field"]},watch:{provider:function(){this.$emit("update:modelValue",null),this.getCredentialFields()}},created:function(){this.getCredentialFields()},methods:{getCredentialFields:function(){var e=this;D[this.provider]?this.$emit("update:modelValue",Object.fromEntries(D[this.provider].map((function(e){return[e.name,null]})))):g["AjaxHelper"].fetch({module:"MobileMessaging",action:"getCredentialFields",provider:this.provider}).then((function(t){e.$emit("update:modelValue",Object.fromEntries(t.map((function(e){return[e.name,null]})))),D[e.provider]=t}))}},computed:{fields:function(){return D[this.provider]}}});F.render=U;var H=F,T=Object(i["defineComponent"])({props:{credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{ActivityIndicator:g["ActivityIndicator"],Field:v["Field"],SaveButton:v["SaveButton"],SmsProviderCredentials:H},directives:{Form:v["Form"]},data:function(){return{isDeletingAccount:!1,isUpdatingAccount:!1,showAccountForm:!1,credentials:null,smsProvider:this.provider}},methods:{deleteApiAccount:function(){var e=this;this.isDeletingAccount=!0,g["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){g["Matomo"].helper.redirect()})).finally((function(){e.isDeletingAccount=!1}))},showUpdateAccount:function(){this.showAccountForm=!0},updateAccount:function(){var e=this;this.isUpdateAccountPossible&&(this.isUpdatingAccount=!0,g["AjaxHelper"].post({method:"MobileMessaging.setSMSAPICredential"},{provider:this.smsProvider,credentials:this.credentials},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){g["Matomo"].helper.redirect()})).finally((function(){e.isUpdatingAccount=!1})))},deleteAccount:function(){var e=this;g["Matomo"].helper.modalConfirm("#confirmDeleteAccount",{yes:function(){e.isDeletingAccount=!0,g["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){e.isDeletingAccount=!1,g["Matomo"].helper.redirect()})).finally((function(){e.isDeletingAccount=!1}))}})},onUpdateOrDeleteClick:function(e){var t=e.target;"displayAccountForm"===t.id?this.showUpdateAccount():"deleteAccount"===t.id&&this.deleteAccount()}},computed:{isUpdateAccountPossible:function(){return!!this.smsProvider&&null!==this.credentials&&Object.values(this.credentials).every((function(e){return!!e}))},updateOrDeleteAccountText:function(){return Object(g["translate"])("MobileMessaging_Settings_UpdateOrDeleteAccount",'<a id="displayAccountForm">',"</a>",'<a id="deleteAccount">',"</a>")},currentProviderDescription:function(){return this.smsProvider&&this.smsProviders?this.smsProviders[this.smsProvider]:""}}});T.render=B;var q=T;function L(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"radio",name:"delegatedManagement",title:e.translate("MobileMessaging_Settings_LetUsersManageAPICredential"),modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.enabled=t}),"full-width":!0,options:e.delegateManagementOptions},null,8,["title","modelValue","options"])]),Object(i["createVNode"])(c,{onConfirm:t[1]||(t[1]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])])}var R=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean]},components:{Field:v["Field"],SaveButton:v["SaveButton"]},data:function(){return{isLoading:!1,enabled:this.delegatedManagement?1:0}},methods:{save:function(){var e=this;this.isLoading=!0,g["AjaxHelper"].post({method:"MobileMessaging.setDelegatedManagement"},{delegatedManagement:this.enabled&&"0"!==this.enabled?"true":"false"}).then((function(){var e=g["NotificationsStore"].show({message:Object(g["translate"])("CoreAdminHome_SettingsSaveSuccess"),id:"mobileMessagingSettings",type:"transient",context:"success"});g["NotificationsStore"].scrollToNotification(e),g["Matomo"].helper.redirect()})).finally((function(){e.isLoading=!1}))}}});R.render=L;var I=R,$={key:0},G={class:"row"},Y={class:"col s12"},z={class:"form-group row"},J={class:"col s12 m6"},K={class:"col s12 m6 form-help"},Q={class:"form-group row addPhoneNumber"},W={class:"col s12 m6"},X={class:"countryCode left"},Z=Object(i["createElementVNode"])("span",{class:"countryCodeSymbol"},"+",-1),ee={class:"phoneNumber left"},te={class:"addNumber left valign-wrapper"},ne={class:"col s12 m6 form-help"},oe={id:"ajaxErrorManagePhoneNumber",ref:"errorContainer"},re=Object(i["createElementVNode"])("div",{id:"notificationManagePhoneNumber"},null,-1),ie={key:1,class:"row"},ae={class:"col s12"},le={class:"col s12 m6"},ce={class:"phoneNumber"},se=["onUpdate:modelValue","placeholder"],de={key:0,class:"form-help col s12 m6"},ue=["onClick"],me=Object(i["createTextVNode"])(" Â  "),be={class:"ui-confirm",id:"confirmDeletePhoneNumber"},pe=["innerHTML"],ge=["value"],ve=["value"];function he(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("Alert"),d=Object(i["resolveComponent"])("ActivityIndicator");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Help")),1),e.isSuperUser?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",$,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedPhoneNumbersOnlyUsedByYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",G,[Object(i["createElementVNode"])("h3",Y,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Add")),1)]),Object(i["createElementVNode"])("div",z,[Object(i["createElementVNode"])("div",J,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"select",name:"countryCodeSelect",title:e.translate("MobileMessaging_Settings_SelectCountry"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.countryCallingCode=t}),"full-width":!0,options:e.countries},null,8,["title","modelValue","options"])])]),Object(i["createElementVNode"])("div",K,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_CountryCode_Help")),1)]),Object(i["createElementVNode"])("div",Q,[Object(i["createElementVNode"])("div",W,[Object(i["createElementVNode"])("div",X,[Z,Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"text",name:"countryCallingCode",title:e.translate("MobileMessaging_Settings_CountryCode"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.countryCallingCode=t}),"full-width":!0,maxlength:4},null,8,["title","modelValue"])])]),Object(i["createElementVNode"])("div",ee,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"text",name:"newPhoneNumber",modelValue:e.newPhoneNumber,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.newPhoneNumber=t}),title:e.translate("MobileMessaging_Settings_PhoneNumber"),"full-width":!0,maxlength:80},null,8,["modelValue","title"])])]),Object(i["createElementVNode"])("div",te,[Object(i["createVNode"])(c,{class:"valign",disabled:!e.canAddNumber||e.isUpdatingPhoneNumbers,onConfirm:t[3]||(t[3]=function(t){return e.addPhoneNumber()}),value:e.translate("General_Add")},null,8,["disabled","value"])]),Object(i["withDirectives"])(Object(i["createVNode"])(s,{severity:"warning",id:"suspiciousPhoneNumber"},{default:Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_SuspiciousPhoneNumber","54184032")),1)]})),_:1},512),[[i["vShow"],e.showSuspiciousPhoneNumber]])]),Object(i["createElementVNode"])("div",ne,Object(i["toDisplayString"])(e.strHelpAddPhone),1)]),Object(i["createElementVNode"])("div",oe,null,512),re,Object.keys(e.phoneNumbers||{}).length>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ie,[Object(i["createElementVNode"])("h3",ae,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ManagePhoneNumbers")),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(d,{loading:e.isUpdatingPhoneNumbers},null,8,["loading"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.phoneNumbers||[],(function(t,n,o){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"form-group row",key:o},[Object(i["createElementVNode"])("div",le,[Object(i["createElementVNode"])("span",ce,Object(i["toDisplayString"])(n),1),t.verified?Object(i["createCommentVNode"])("",!0):Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("input",{key:0,type:"text",class:"verificationCode","onUpdate:modelValue":function(t){return e.validationCode[o]=t},placeholder:e.translate("MobileMessaging_Settings_EnterActivationCode"),style:{"margin-right":"3.5px"}},null,8,se)),[[i["vModelText"],e.validationCode[o]]]),t.verified?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:1,disabled:!e.validationCode[o]||e.isUpdatingPhoneNumbers,onConfirm:function(t){return e.validateActivationCode(n,o)},value:e.translate("MobileMessaging_Settings_ValidatePhoneNumber")},null,8,["disabled","onConfirm","value"])),Object(i["createVNode"])(c,{disabled:e.isUpdatingPhoneNumbers,onConfirm:function(t){return e.removePhoneNumber(n)},value:e.translate("General_Remove"),style:{"margin-left":"3.5px"}},null,8,["disabled","onConfirm","value"])]),t.verified?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",de,[Object(i["createElementVNode"])("div",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_VerificationCodeJustSent"))+" ",1),Object(i["createElementVNode"])("a",{onClick:function(t){return e.resendVerificationCode(n,o)}},Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ResendVerification")),9,ue)]),me]))])})),128))]),Object(i["createElementVNode"])("div",be,[Object(i["createElementVNode"])("h2",{innerHTML:e.$sanitize(e.removeNumberConfirmation)},null,8,pe),Object(i["createElementVNode"])("input",{type:"button",role:"yes",value:e.translate("General_Yes")},null,8,ge),Object(i["createElementVNode"])("input",{type:"button",role:"no",value:e.translate("General_No")},null,8,ve)])],64)}var fe=Object(i["defineComponent"])({props:{isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0}},components:{Field:v["Field"],SaveButton:v["SaveButton"],Alert:g["Alert"],ActivityIndicator:g["ActivityIndicator"]},data:function(){return{isUpdatingPhoneNumbers:!1,phoneNumbers:{},countryCallingCode:this.defaultCallingCode||"",newPhoneNumber:"",validationCode:{},numberToRemove:""}},mounted:function(){this.updatePhoneNumbers()},methods:{validateActivationCode:function(e,t){var n=this;if(this.validationCode[t]){var o=this.validationCode[t];this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.validatePhoneNumber"},{phoneNumber:e,verificationCode:o},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(e){var t;if(e&&e.value){var o=Object(g["translate"])("MobileMessaging_Settings_PhoneActivated");t=g["NotificationsStore"].show({message:o,placeat:"#notificationManagePhoneNumber",context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"}),n.updatePhoneNumbers()}else{var r=Object(g["translate"])("MobileMessaging_Settings_InvalidActivationCode");t=g["NotificationsStore"].show({message:r,placeat:"#notificationManagePhoneNumber",context:"error",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"})}g["NotificationsStore"].scrollToNotification(t)})).finally((function(){n.validationCode[t]="",n.isUpdatingPhoneNumbers=!1}))}},resendVerificationCode:function(e){var t=this;this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.resendVerificationCode"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(){var e=Object(g["translate"])("MobileMessaging_Settings_NewVerificationCodeSent"),n=g["NotificationsStore"].show({message:e,placeat:"#notificationManagePhoneNumber",context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"});g["NotificationsStore"].scrollToNotification(n),t.updatePhoneNumbers()})).finally((function(){t.isUpdatingPhoneNumbers=!1}))},updatePhoneNumbers:function(){var e=this;this.isUpdatingPhoneNumbers=!0,g["AjaxHelper"].post({method:"MobileMessaging.getPhoneNumbers"},{}).then((function(t){e.phoneNumbers=t,e.isUpdatingPhoneNumbers=!1}))},removePhoneNumber:function(e){var t=this;e&&(this.numberToRemove=e,this.clearNotifcationsAndErrorsContainer(),g["Matomo"].helper.modalConfirm("#confirmDeletePhoneNumber",{yes:function(){t.isUpdatingPhoneNumbers=!0,g["AjaxHelper"].post({method:"MobileMessaging.removePhoneNumber"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(){t.updatePhoneNumbers()})).finally((function(){t.isUpdatingPhoneNumbers=!1,t.numberToRemove=""}))}}))},addPhoneNumber:function(){var e=this,t="+".concat(this.countryCallingCode).concat(this.newPhoneNumber);this.canAddNumber&&t.length>1&&(this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.addPhoneNumber"},{phoneNumber:t},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(){e.updatePhoneNumbers(),e.countryCallingCode="",e.newPhoneNumber=""})).finally((function(){e.isUpdatingPhoneNumbers=!1})))},clearNotifcationsAndErrorsContainer:function(){this.$refs.errorContainer.innerHTML="",g["NotificationsStore"].remove("MobileMessaging_ValidatePhoneNumber")}},computed:{showSuspiciousPhoneNumber:function(){return 0===this.newPhoneNumber.trim().lastIndexOf("0",0)},canAddNumber:function(){return!!this.newPhoneNumber&&""!==this.newPhoneNumber},removeNumberConfirmation:function(){return Object(g["translate"])("MobileMessaging_ConfirmRemovePhoneNumber",this.numberToRemove)}}});fe.render=he;var je=fe,Oe={class:"manageMobileMessagingSettings"},Ne={key:0},Me={key:0},Se={class:"ui-confirm",id:"confirmDeleteAccount"},ye=["value"],Ce=["value"];function Pe(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("DelegateMobileMessagingSettings"),c=Object(i["resolveComponent"])("ContentBlock"),s=Object(i["resolveComponent"])("ManageSmsProvider"),d=Object(i["resolveComponent"])("ManageMobilePhoneNumbers");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Oe,[e.isSuperUser?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:0,"content-title":e.translate("MobileMessaging_SettingsMenu")},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(l,{"delegate-management-options":e.delegateManagementOptions,"delegated-management":e.delegatedManagement},null,8,["delegate-management-options","delegated-management"])]})),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),e.accountManagedByCurrentUser?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:1,"content-title":e.translate("MobileMessaging_Settings_SMSProvider"),feature:"true"},{default:Object(i["withCtx"])((function(){return[e.isSuperUser&&e.delegatedManagement?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Ne,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedSmsProviderOnlyAppliesToYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(s,{"credential-supplied":e.credentialSupplied,"credential-error":e.credentialError,provider:e.provider,"credit-left":e.creditLeft,"sms-provider-options":e.smsProviderOptions,"sms-providers":e.smsProviders},null,8,["credential-supplied","credential-error","provider","credit-left","sms-provider-options","sms-providers"])]})),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(c,{"content-title":e.translate("MobileMessaging_PhoneNumbers")},{default:Object(i["withCtx"])((function(){return[e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createBlock"])(d,{key:1,"is-super-user":e.isSuperUser,"default-calling-code":e.defaultCallingCode,countries:e.countries,"str-help-add-phone":e.strHelpAddPhone,"phone-numbers":e.phoneNumbers},null,8,["is-super-user","default-calling-code","countries","str-help-add-phone","phone-numbers"])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Me,Object(i["toDisplayString"])(e.accountManagedByCurrentUser?e.translate("MobileMessaging_Settings_CredentialNotProvided"):e.translate("MobileMessaging_Settings_CredentialNotProvidedByAdmin")),1))]})),_:1},8,["content-title"]),Object(i["createElementVNode"])("div",Se,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DeleteAccountConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ye),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ce)])])}var Ve=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean],isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0},phoneNumbers:Object,accountManagedByCurrentUser:Boolean,credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{ContentBlock:g["ContentBlock"],DelegateMobileMessagingSettings:I,ManageMobilePhoneNumbers:je,ManageSmsProvider:q}});Ve.render=Pe;var Ae=Ve;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=MobileMessaging.umd.min.js.map