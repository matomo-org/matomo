(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["UserCountry"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["UserCountry"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,r){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="plugins/UserCountry/vue/dist/",r(r.s="fae3")}({"19dc":function(t,r){t.exports=e},"8bbf":function(e,r){e.exports=t},a5a2:function(e,t){e.exports=r},fae3:function(e,t,r){"use strict";if(r.r(t),r.d(t,"LocationProviderSelection",(function(){return w})),r.d(t,"AdminPage",(function(){return G})),r.d(t,"GetDistinctCountries",(function(){return R})),"undefined"!==typeof window){var o=window.document.currentScript,n=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(r.p=n[1])}var i=r("8bbf");const c={class:"locationProviderSelection"},l=["innerHTML"],a={class:"row"},s={class:"col s12 push-m9 m3"},d={class:"col s12 m4 l2"},u=["id","disabled","checked","onChange"],p={class:"loc-provider-status"},b={key:0,class:"is-not-installed"},j={key:1,class:"is-installed"},O={key:2,class:"is-broken"},m={class:"col s12 m4 l6"},v=["innerHTML"],f=["innerHTML"],y={class:"col s12 m4 l4"},k={key:0,class:"form-help"},g={key:0},h=Object(i["createElementVNode"])("br",null,null,-1),C={style:{position:"absolute"}},P=["innerHTML"],N={class:"text-right"},B=["onClick"],E={key:1},V={key:1,class:"form-help"},L={key:0},S=["innerHTML"],I=["innerHTML"],_={key:1},x=["innerHTML"];function T(e,t,r,o,n,T){const D=Object(i["resolveComponent"])("ActivityIndicator"),H=Object(i["resolveComponent"])("Notification"),M=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",c,[e.isThereWorkingProvider?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,innerHTML:e.$sanitize(e.setUpGuides||"")},null,8,l)),Object(i["createElementVNode"])("div",a,[Object(i["createElementVNode"])("div",s,Object(i["toDisplayString"])(e.translate("General_InfoFor",e.thisIp)),1)]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.visibleLocationProviders,(t,r)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:r,class:Object(i["normalizeClass"])("row form-group provider"+r)},[Object(i["createElementVNode"])("div",d,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("label",null,[Object(i["createElementVNode"])("input",{class:"location-provider",name:"location-provider",type:"radio",id:"provider_input_"+r,disabled:1!==t.status,checked:e.selectedProvider===r,onChange:t=>e.selectedProvider=r},null,40,u),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translateOrDefault(t.title)),1)])]),Object(i["createElementVNode"])("p",p,[0===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",b,Object(i["toDisplayString"])(e.translate("General_NotInstalled")),1)):1===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",j,Object(i["toDisplayString"])(e.translate("General_Installed")),1)):2===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",O,Object(i["toDisplayString"])(e.translate("General_Broken")),1)):Object(i["createCommentVNode"])("",!0)])]),Object(i["createElementVNode"])("div",m,[Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.translateOrDefault(t.description))},null,8,v),1!==t.status&&t.install_docs?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(t.install_docs)},null,8,f)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",y,[1===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",k,["127.0.0.1"!==e.thisIp&&"::1"!==e.thisIp?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",g,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("UserCountry_CurrentLocationIntro"))+": ",1),Object(i["createElementVNode"])("div",null,[h,Object(i["createElementVNode"])("div",C,[Object(i["createVNode"])(D,{loading:e.updateLoading[r]},null,8,["loading"])]),Object(i["createElementVNode"])("span",{class:"location",style:Object(i["normalizeStyle"])({visibility:e.providerLocations[r]?"visible":"hidden"})},[Object(i["createElementVNode"])("strong",{innerHTML:e.$sanitize(e.providerLocations[r]||"Â ")},null,8,P)],4)]),Object(i["createElementVNode"])("div",N,[Object(i["createElementVNode"])("a",{onClick:Object(i["withModifiers"])(t=>e.refreshProviderInfo(r),["prevent"])},Object(i["toDisplayString"])(e.translate("General_Refresh")),9,B)])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",E,Object(i["toDisplayString"])(e.translate("UserCountry_CannotLocalizeLocalIP",e.thisIp)),1))])):Object(i["createCommentVNode"])("",!0),t.statusMessage?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",V,[2===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("strong",L,Object(i["toDisplayString"])(e.translate("General_Error"))+":",1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(t.statusMessage)},null,8,S)])):Object(i["createCommentVNode"])("",!0),t.extra_message?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:2,class:"form-help",innerHTML:e.$sanitize(t.extra_message)},null,8,I)):Object(i["createCommentVNode"])("",!0)])],2))),128)),Object.keys(e.locationProvidersNotDefaultOrDisabled).length?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",_,[Object(i["createVNode"])(H,{noclear:!0,context:"warning"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.noProvidersText)},null,8,x)]),_:1})])),Object(i["createVNode"])(M,{onConfirm:t[0]||(t[0]=t=>e.save()),saving:e.isLoading},null,8,["saving"])])}var D=r("19dc"),H=r("a5a2"),M=Object(i["defineComponent"])({props:{currentProviderId:{type:String,required:!0},isThereWorkingProvider:Boolean,setUpGuides:String,thisIp:{type:String,required:!0},locationProviders:{type:Object,required:!0},defaultProviderId:{type:String,required:!0},disabledProviderId:{type:String,required:!0}},components:{ActivityIndicator:D["ActivityIndicator"],Notification:D["Notification"],SaveButton:H["SaveButton"]},data(){return{isLoading:!1,updateLoading:{},selectedProvider:this.currentProviderId,providerLocations:Object.fromEntries(Object.entries(this.locationProviders).map(([e,t])=>[e,t.location]))}},methods:{refreshProviderInfo(e){this.updateLoading[e]=!0,delete this.providerLocations[e],D["AjaxHelper"].fetch({module:"UserCountry",action:"getLocationUsingProvider",id:e,format:"html"},{format:"html"}).then(t=>{this.providerLocations[e]=t}).finally(()=>{this.updateLoading[e]=!1})},save(){this.selectedProvider&&(this.isLoading=!0,D["AjaxHelper"].fetch({method:"UserCountry.setLocationProvider",providerId:this.selectedProvider},{withTokenInUrl:!0}).then(()=>{const e=D["NotificationsStore"].show({message:Object(D["translate"])("General_Done"),context:"success",noclear:!0,type:"toast",id:"userCountryLocationProvider"});D["NotificationsStore"].scrollToNotification(e)}).finally(()=>{this.isLoading=!1}))}},computed:{visibleLocationProviders(){return Object.fromEntries(Object.entries(this.locationProviders).filter(([,e])=>e.isVisible))},locationProvidersNotDefaultOrDisabled(){return Object.fromEntries(Object.entries(this.locationProviders).filter(([,e])=>e.id!==this.defaultProviderId&&e.id!==this.disabledProviderId))},noProvidersText(){return Object(D["translate"])("UserCountry_NoProviders",'<a rel="noreferrer noopener" href="https://db-ip.com/?refid=mtm" target="_blank">',"</a>")}}});M.render=T;var w=M;function q(e,t,r,o,n,c){const l=Object(i["resolveComponent"])("EnrichedHeadline"),a=Object(i["resolveComponent"])("LocationProviderSelection"),s=Object(i["resolveComponent"])("ContentBlock"),d=Object(i["resolveDirective"])("content-intro");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h2",null,[Object(i["createVNode"])(l,{"help-url":e.externalRawLink("https://matomo.org/docs/geo-locate/"),id:"location-providers"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("UserCountry_Geolocation")),1)]),_:1},8,["help-url"])]),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("UserCountry_GeolocationPageDesc")),1)])),[[d]]),Object(i["createVNode"])(s,{"content-title":e.translate("UserCountry_LocationProvider")},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(a,{"current-provider-id":e.currentProviderId,"is-there-working-provider":e.isThereWorkingProvider,"set-up-guides":e.setUpGuides,"this-ip":e.thisIp,"location-providers":e.locationProviders,"default-provider-id":e.defaultProviderId,"disabled-provider-id":e.disabledProviderId},null,8,["current-provider-id","is-there-working-provider","set-up-guides","this-ip","location-providers","default-provider-id","disabled-provider-id"])]),_:1},8,["content-title"])],64)}var U=Object(i["defineComponent"])({props:{currentProviderId:{type:String,required:!0},isThereWorkingProvider:Boolean,setUpGuides:String,thisIp:{type:String,required:!0},locationProviders:{type:Object,required:!0},defaultProviderId:{type:String,required:!0},disabledProviderId:{type:String,required:!0}},components:{ContentBlock:D["ContentBlock"],LocationProviderSelection:w,EnrichedHeadline:D["EnrichedHeadline"]},directives:{ContentIntro:D["ContentIntro"],ContentBlock:D["ContentBlock"]}});U.render=q;var G=U;const z={class:"sparkline"},A=["innerHTML"],$=Object(i["createElementVNode"])("br",{style:{clear:"left"}},null,-1);function W(e,t,r,o,n,c){const l=Object(i["resolveComponent"])("Sparkline"),a=Object(i["resolveComponent"])("ContentBlock");return Object(i["openBlock"])(),Object(i["createBlock"])(a,null,{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",z,[Object(i["createVNode"])(l,{params:e.urlSparklineCountries,width:100,height:25},null,8,["params"]),Object(i["createElementVNode"])("div",{innerHTML:e.$sanitize(e.distinctCountriesText)},null,8,A)]),$]),_:1})}var F=Object(i["defineComponent"])({props:{numberDistinctCountries:{type:Number,required:!0},urlSparklineCountries:{type:[Object,String],required:!0}},components:{ContentBlock:D["ContentBlock"],Sparkline:D["Sparkline"]},computed:{distinctCountriesText(){return Object(D["translate"])("UserCountry_DistinctCountries",`<strong>${this.numberDistinctCountries}</strong>`)}}});F.render=W;var R=F;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=UserCountry.umd.min.js.map